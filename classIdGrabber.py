from selenium import webdriver
from selenium.webdriver.common.by import By
from bs4 import BeautifulSoup
import requests
import time

classes =[{"label":"Aerospace Studies (AERO ST)","value":"AERO ST"},{"label":"African American Studies (AF AMER)","value":"AF AMER"},{"label":"African Studies (AFRC ST)","value":"AFRC ST"},{"label":"American Indian Studies (AM IND)","value":"AM IND "},{"label":"American Sign Language (ASL)","value":"ASL    "},{"label":"Ancient Near East (AN N EA)","value":"AN N EA"},{"label":"Anesthesiology (ANES)","value":"ANES   "},{"label":"Anthropology (ANTHRO)","value":"ANTHRO "},{"label":"Applied Chemical Sciences (APP CHM)","value":"APP CHM"},{"label":"Applied Linguistics (APPLING)","value":"APPLING"},{"label":"Arabic","value":"ARABIC "},{"label":"Archaeology (ARCHEOL)","value":"ARCHEOL"},{"label":"Architecture and Urban Design (ARCH&UD)","value":"ARCH&UD"},{"label":"Armenian (ARMENIA)","value":"ARMENIA"},{"label":"Art","value":"ART    "},{"label":"Art History (ART HIS)","value":"ART HIS"},{"label":"Arts Education (ARTS ED)","value":"ARTS ED"},{"label":"Asian","value":"ASIAN  "},{"label":"Asian American Studies (ASIA AM)","value":"ASIA AM"},{"label":"Astronomy (ASTR)","value":"ASTR   "},{"label":"Atmospheric and Oceanic Sciences (A&O SCI)","value":"A&O SCI"},{"label":"Bioengineering (BIOENGR)","value":"BIOENGR"},{"label":"Bioinformatics (Graduate) (BIOINFO)","value":"BIOINFO"},{"label":"Bioinformatics (Undergraduate) (BIOINFR)","value":"BIOINFR"},{"label":"Biological Chemistry (BIOL CH)","value":"BIOL CH"},{"label":"Biomathematics (BIOMATH)","value":"BIOMATH"},{"label":"Biomedical Research (BMD RES)","value":"BMD RES"},{"label":"Biostatistics (BIOSTAT)","value":"BIOSTAT"},{"label":"Central and East European Studies (C&EE ST)","value":"C&EE ST"},{"label":"Chemical Engineering (CH ENGR)","value":"CH ENGR"},{"label":"Chemistry and Biochemistry (CHEM)","value":"CHEM   "},{"label":"Chicana/o and Central American Studies (CCAS)","value":"CCAS   "},{"label":"Chinese (CHIN)","value":"CHIN   "},{"label":"Civil and Environmental Engineering (C&EE)","value":"C&EE   "},{"label":"Classics (CLASSIC)","value":"CLASSIC"},{"label":"Clusters (CLUSTER)","value":"CLUSTER"},{"label":"Communication (COMM)","value":"COMM   "},{"label":"Community Engagement and Social Change (CESC)","value":"CESC   "},{"label":"Community Health Sciences (COM HLT)","value":"COM HLT"},{"label":"Comparative Literature (COM LIT)","value":"COM LIT"},{"label":"Computational and Systems Biology (C&S BIO)","value":"C&S BIO"},{"label":"Computer Science (COM SCI)","value":"COM SCI"},{"label":"Conservation of Cultural Heritage (CLT HTG)","value":"CLT HTG"},{"label":"Dance","value":"DANCE  "},{"label":"Dentistry (DENT)","value":"DENT   "},{"label":"Design / Media Arts (DESMA)","value":"DESMA  "},{"label":"Digital Humanities (DGT HUM)","value":"DGT HUM"},{"label":"Disability Studies (DIS STD)","value":"DIS STD"},{"label":"Dutch","value":"DUTCH  "},{"label":"Earth, Planetary, and Space Sciences (EPS SCI)","value":"EPS SCI"},{"label":"East Asian Studies (EA STDS)","value":"EA STDS"},{"label":"Ecology and Evolutionary Biology (EE BIOL)","value":"EE BIOL"},{"label":"Economics (ECON)","value":"ECON   "},{"label":"Education (EDUC)","value":"EDUC   "},{"label":"Electrical and Computer Engineering (EC ENGR)","value":"EC ENGR"},{"label":"Engineering (ENGR)","value":"ENGR   "},{"label":"English (ENGL)","value":"ENGL   "},{"label":"English as A Second Language (ESL)","value":"ESL    "},{"label":"English Composition (ENGCOMP)","value":"ENGCOMP"},{"label":"Environment (ENVIRON)","value":"ENVIRON"},{"label":"Environmental Health Sciences (ENV HLT)","value":"ENV HLT"},{"label":"Epidemiology (EPIDEM)","value":"EPIDEM "},{"label":"Ethnomusicology (ETHNMUS)","value":"ETHNMUS"},{"label":"European Languages and Transcultural Studies (ELTS)","value":"ELTS   "},{"label":"Fiat Lux (FIAT LX)","value":"FIAT LX"},{"label":"Filipino (FILIPNO)","value":"FILIPNO"},{"label":"Film and Television (FILM TV)","value":"FILM TV"},{"label":"Food Studies (FOOD ST)","value":"FOOD ST"},{"label":"French (FRNCH)","value":"FRNCH  "},{"label":"Gender Studies (GENDER)","value":"GENDER "},{"label":"Geography (GEOG)","value":"GEOG   "},{"label":"German","value":"GERMAN "},{"label":"Gerontology (GRNTLGY)","value":"GRNTLGY"},{"label":"Global Health (GLB HLT)","value":"GLB HLT"},{"label":"Global Jazz Studies (GJ STDS)","value":"GJ STDS"},{"label":"Global Studies (GLBL ST)","value":"GLBL ST"},{"label":"Graduate Student Professional Development (GRAD PD)","value":"GRAD PD"},{"label":"Greek","value":"GREEK  "},{"label":"Health Policy and Management (HLT POL)","value":"HLT POL"},{"label":"Healthcare Administration (HLT ADM)","value":"HLT ADM"},{"label":"Hebrew","value":"HEBREW "},{"label":"Hindi-Urdu (HIN-URD)","value":"HIN-URD"},{"label":"History (HIST)","value":"HIST   "},{"label":"Honors Collegium (HNRS)","value":"HNRS   "},{"label":"Human Genetics (HUM GEN)","value":"HUM GEN"},{"label":"Hungarian (HNGAR)","value":"HNGAR  "},{"label":"Indigenous Languages of the Americas (IL AMER)","value":"IL AMER"},{"label":"Indo-European Studies (I E STD)","value":"I E STD"},{"label":"Indonesian (INDO)","value":"INDO   "},{"label":"Information Studies (INF STD)","value":"INF STD"},{"label":"International and Area Studies (I A STD)","value":"I A STD"},{"label":"International Development Studies (INTL DV)","value":"INTL DV"},{"label":"International Migration Studies (I M STD)","value":"I M STD"},{"label":"Iranian","value":"IRANIAN"},{"label":"Islamic Studies (ISLM ST)","value":"ISLM ST"},{"label":"Italian","value":"ITALIAN"},{"label":"Japanese (JAPAN)","value":"JAPAN  "},{"label":"Jewish Studies (JEWISH)","value":"JEWISH "},{"label":"Korean (KOREA)","value":"KOREA  "},{"label":"Labor Studies (LBR STD)","value":"LBR STD"},{"label":"Latin","value":"LATIN  "},{"label":"Latin American Studies (LATN AM)","value":"LATN AM"},{"label":"Law","value":"LAW    "},{"label":"Lesbian, Gay, Bisexual, Transgender, and Queer Studies (LGBTQS)","value":"LGBTQS "},{"label":"Life Sciences (LIFESCI)","value":"LIFESCI"},{"label":"Linguistics (LING)","value":"LING   "},{"label":"Management (MGMT)","value":"MGMT   "},{"label":"Management-Executive MBA (MGMTEX)","value":"MGMTEX "},{"label":"Management-Full-Time MBA (MGMTFT)","value":"MGMTFT "},{"label":"Management-Fully Employed MBA (MGMTFE)","value":"MGMTFE "},{"label":"Management-Global Executive MBA Asia Pacific (MGMTGEX)","value":"MGMTGEX"},{"label":"Management-Master of Financial Engineering (MGMTMFE)","value":"MGMTMFE"},{"label":"Management-Master of Science in Business Analytics (MGMTMSA)","value":"MGMTMSA"},{"label":"Management-PhD (MGMTPHD)","value":"MGMTPHD"},{"label":"Materials Science and Engineering (MAT SCI)","value":"MAT SCI"},{"label":"Mathematics (MATH)","value":"MATH   "},{"label":"Mechanical and Aerospace Engineering (MECH&AE)","value":"MECH&AE"},{"label":"Medicine (MED)","value":"MED    "},{"label":"Microbiology, Immunology, and Molecular Genetics (MIMG)","value":"MIMG   "},{"label":"Middle Eastern Studies (M E STD)","value":"M E STD"},{"label":"Military Science (MIL SCI)","value":"MIL SCI"},{"label":"Molecular and Medical Pharmacology (M PHARM)","value":"M PHARM"},{"label":"Molecular Biology (MOL BIO)","value":"MOL BIO"},{"label":"Molecular Toxicology (MOL TOX)","value":"MOL TOX"},{"label":"Molecular, Cell, and Developmental Biology (MCD BIO)","value":"MCD BIO"},{"label":"Molecular, Cellular, and Integrative Physiology (MC&IP)","value":"MC&IP  "},{"label":"Music (MUSC)","value":"MUSC   "},{"label":"Music Industry (MSC IND)","value":"MSC IND"},{"label":"Musicology (MUSCLG)","value":"MUSCLG "},{"label":"Naval Science (NAV SCI)","value":"NAV SCI"},{"label":"Near Eastern Languages (NR EAST)","value":"NR EAST"},{"label":"Neurobiology (NEURBIO)","value":"NEURBIO"},{"label":"Neurology (NEURLGY)","value":"NEURLGY"},{"label":"Neuroscience (Graduate) (NEURO)","value":"NEURO  "},{"label":"Neuroscience (NEUROSC)","value":"NEUROSC"},{"label":"Neurosurgery (NEURSGY)","value":"NEURSGY"},{"label":"Nursing","value":"NURSING"},{"label":"Obstetrics and Gynecology (OBGYN)","value":"OBGYN  "},{"label":"Ophthalmology (OPTH)","value":"OPTH   "},{"label":"Oral Biology (ORL BIO)","value":"ORL BIO"},{"label":"Orthopaedic Surgery (ORTHPDC)","value":"ORTHPDC"},{"label":"Pathology and Laboratory Medicine (PATH)","value":"PATH   "},{"label":"Pediatrics (PEDS)","value":"PEDS   "},{"label":"Philosophy (PHILOS)","value":"PHILOS "},{"label":"Physics","value":"PHYSICS"},{"label":"Physics and Biology in Medicine (PBMED)","value":"PBMED  "},{"label":"Physiological Science (PHYSCI)","value":"PHYSCI "},{"label":"Physiology (PHYSIOL)","value":"PHYSIOL"},{"label":"Polish (POLSH)","value":"POLSH  "},{"label":"Political Science (POL SCI)","value":"POL SCI"},{"label":"Portuguese (PORTGSE)","value":"PORTGSE"},{"label":"Program in Computing (COMPTNG)","value":"COMPTNG"},{"label":"Psychiatry and Biobehavioral Sciences (PSYCTRY)","value":"PSYCTRY"},{"label":"Psychology (PSYCH)","value":"PSYCH  "},{"label":"Public Affairs (PUB AFF)","value":"PUB AFF"},{"label":"Public Health (PUB HLT)","value":"PUB HLT"},{"label":"Public Policy (PUB PLC)","value":"PUB PLC"},{"label":"Quantum Science and Technology (QNT SCI)","value":"QNT SCI"},{"label":"Radiation Oncology (RAD ONC)","value":"RAD ONC"},{"label":"Religion, Study of (RELIGN)","value":"RELIGN "},{"label":"Research Practice (RES PRC)","value":"RES PRC"},{"label":"Romanian (ROMANIA)","value":"ROMANIA"},{"label":"Russian (RUSSN)","value":"RUSSN  "},{"label":"Scandinavian (SCAND)","value":"SCAND  "},{"label":"Science Education (SCI EDU)","value":"SCI EDU"},{"label":"Serbian/Croatian (SRB CRO)","value":"SRB CRO"},{"label":"Slavic (SLAVC)","value":"SLAVC  "},{"label":"Social Science (SOC SC)","value":"SOC SC "},{"label":"Social Thought (SOC THT)","value":"SOC THT"},{"label":"Social Welfare (SOC WLF)","value":"SOC WLF"},{"label":"Society and Genetics (SOC GEN)","value":"SOC GEN"},{"label":"Sociology (SOCIOL)","value":"SOCIOL "},{"label":"South Asian (S ASIAN)","value":"S ASIAN"},{"label":"Southeast Asian (SEASIAN)","value":"SEASIAN"},{"label":"Spanish (SPAN)","value":"SPAN   "},{"label":"Statistics (STATS)","value":"STATS  "},{"label":"Surgery","value":"SURGERY"},{"label":"Swahili","value":"SWAHILI"},{"label":"Thai","value":"THAI   "},{"label":"Theater","value":"THEATER"},{"label":"Turkic Languages (TURKIC)","value":"TURKIC "},{"label":"University Studies (UNIV ST)","value":"UNIV ST"},{"label":"Urban Planning (URBN PL)","value":"URBN PL"},{"label":"Urology","value":"UROLOGY"},{"label":"Vietnamese (VIETMSE)","value":"VIETMSE"},{"label":"World Arts and Cultures (WL ARTS)","value":"WL ARTS"},{"label":"Yiddish (YIDDSH)","value":"YIDDSH "}]


def scrape_class_id_page(driver):
    try:
        class_eles=driver.execute_script('return document.querySelector("ucla-sa-soc-app").shadowRoot.querySelectorAll("*.row-fluid.class-title")')
        curr_ids =[]
        for div in class_eles:
            curr_ids.append(div.get_attribute('id'))
        expand_all_button = driver.execute_script('return document.querySelector("ucla-sa-soc-app").shadowRoot.getElementById("expandAll")')
        if expand_all_button is None:
            return
        expand_all_button.click()
        time.sleep(5)
        for class_id in curr_ids:
            ele=driver.execute_script(f'return document.querySelector("ucla-sa-soc-app").shadowRoot.getElementById("{class_id}-children")')
            if ele is not None:
                child_div = ele.find_element(By.XPATH, "./div")
                print(child_div.get_attribute("id"))
    except:
        return
def scrape_class_id_subject(url):
    try:
        # create a new instance of the Chrome driver
        driver = webdriver.Chrome()
        driver.implicitly_wait(10)

        driver.get(url)
        
        eles=driver.execute_script('return document.querySelector("ucla-sa-soc-app").shadowRoot.querySelectorAll("*.demo1")[1].querySelectorAll("button")')

        buttonsC=len(eles)
        time.sleep(5)
        scrape_class_id_page(driver)
        for button in range(2,buttonsC-2):
            eles=driver.execute_script('return document.querySelector("ucla-sa-soc-app").shadowRoot.querySelectorAll("*.demo1")[1].querySelectorAll("button")')
            ele=eles[button]
            assert(ele.get_attribute("className") == '')
            ele.click()
            time.sleep(5)
            scrape_class_id_page(driver)
    except:
        return

for curr_class in classes:
    url = f'https://sa.ucla.edu/ro/public/soc/Results?SubjectAreaName={curr_class["label"]}&t=23S&sBy=subject&subj={curr_class["value"]}'
    scrape_class_id_subject(url)

# scrape_class_id_subject("https://sa.ucla.edu/ro/public/soc/Results?SubjectAreaName=Electrical+and+Computer+Engineering+(EC+ENGR)&t=23S&sBy=subject&subj=EC+ENGR&catlg=&cls_no=&undefined=Go&btnIsInIndex=btn_inIndex")